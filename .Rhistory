names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2%>%filter(Country %in% c("Malaysia","Singapore")),
aes(x=year,y=country,fill=hdi)) +
geom_tile()
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2%>%filter(Country %in% c("Malaysia","Singapore")),
aes(x=year,y=Country,fill=hdi)) +
geom_tile()
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2%>%filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020)),
aes(x=year,y=Country,fill=hdi)) +
geom_tile()
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2%>%filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020)),
) +
geom_tile(aes(x=year,y=Country,fill=hdi),col="white") +
geom_text(aes(x=year, y=Country, label = hdi),col="white",size=6) +
theme(axis.text = element_text(size=17, face="bold"),
axis.ticks = element_blank())+
labs(title="", x="", y="")
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2 %>% select(HDI=hdi,.) %>%
filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020))) +
geom_tile(aes(x=year,y=Country,fill=hdi),col="white") +
geom_text(aes(x=year, y=Country, label = hdi),col="white",size=6) +
theme(axis.text = element_text(size=17, face="bold"),
axis.ticks = element_blank())+
labs(title="", x="", y="")
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2 %>% select(Country,HDI=hdi,year) %>%
filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020))) +
geom_tile(aes(x=year,y=Country,fill=hdi),col="white") +
geom_text(aes(x=year, y=Country, label = hdi),col="white",size=6) +
theme(axis.text = element_text(size=17, face="bold"),
axis.ticks = element_blank())+
labs(title="", x="", y="")
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2 %>% select(Country,HDI=hdi,year) %>%
filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020))) +
geom_tile(aes(x=year,y=Country,fill=HDI),col="white") +
geom_text(aes(x=year, y=Country, label = HDI),col="white",size=6) +
theme(axis.text = element_text(size=17, face="bold"),
axis.ticks = element_blank())+
labs(title="", x="", y="")
df_read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_read2 = df_read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.","0"))) %>%
mutate_all(funs(as.double(.)))
df_rank2 = cbind(Country=df_read$Country,df_read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_rank = df_rank2 %>%
group_by(year) %>%
arrange(desc(hdi)) %>%
mutate(rank=rank(I(-hdi),ties.method="min")) %>%
ungroup() %>%
group_by(Country) %>%
filter(rank==min(rank)) %>%
arrange(year) %>%
slice_head() %>%
ungroup()
df_rank %>% filter(Country %in% c("Malaysia","Singapore"))
ggplot(data=df_rank2 %>% select(Country,HDI=hdi,year) %>%
filter(Country %in% c("Malaysia","Singapore"),
year %in% c(1990,2000,2010,2020))) +
geom_tile(aes(x=year,y=Country,fill=HDI),col="white") +
geom_text(aes(x=year, y=Country, label = HDI),col="white",size=6) +
theme(axis.ticks = element_blank()) +
labs(title="", x="", y="")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_rank2 %>%
left_join(df_4, by=c("Country"="country"))
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_rank2 %>%
left_join(df_4, by=c("Country"="country"))
df_4
df_4 = read.csv("../data/data4_finals.csv")
#df_4 = df_rank2 %>%
#left_join(df_4, by=c("Country"="country"))
df_4
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_rank2 %>%
left_join(df_4, by=c("Country"="country"))
df_4
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi)) %>%
ungroup()
df_4
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4
ggplot(df_4, aes(x=year,y=hdi)) +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4
ggplot(df_4, aes(x=year,y=hdi)) +
geom_line()
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4
ggplot(df_4, aes(x=year,y=hdi)) +
geom_line() +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4, aes(x=year,y=hdi)) +
geom_line() +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(hdi = mean(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4, aes(x=year,y=hdi)) +
geom_line() +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(mean_hdi = mean(hdi,na.rm=TRUE),
median_hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4) +
geom_line(aes(x=year,y=mean_hdi)) +
geom_line(aes(x=year,y=median_hdi)) +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(mean_hdi = mean(hdi,na.rm=TRUE),
median_hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4) +
geom_line(aes(x=year,y=mean_hdi),col="blue") +
geom_line(aes(x=year,y=median_hdi),col="red") +
facet_wrap(~Region.Name)
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(mean_hdi = mean(hdi,na.rm=TRUE),
median_hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4) +
geom_line(aes(x=year,y=mean_hdi,color="line1")) +
geom_line(aes(x=year,y=median_hdi,color="line2")) +
scale_color_manual(values=c("line1"="blue","line2"="red")) +
facet_wrap(~Region.Name) +
labs(x="year",y="HDI",color="Legend")
df_3read = read_excel("../data/data3_finals.xlsx",skip=4,range="A5:I195",col_names=TRUE)
df_3read2 = df_3read %>%
select(-Country) %>%
mutate_all(funs(str_replace_all(.,"\\.\\.",NA_character_))) %>%
mutate_all(funs(as.double(.)))
df_3 = cbind(Country=df_read$Country,df_3read2) %>%
pivot_longer(cols=-Country,
names_to="year",
values_to="hdi")
df_4 = read.csv("../data/data4_finals.csv")
df_4 = df_3 %>%
left_join(df_4, by=c("Country"="country")) %>%
group_by(Region.Name, year) %>%
summarise(mean_hdi = mean(hdi,na.rm=TRUE),
median_hdi = median(hdi,na.rm=TRUE)) %>%
ungroup()
df_4 = df_4 %>%
mutate(year = as.double(year))
ggplot(df_4) +
geom_line(aes(x=year,y=mean_hdi,color="Mean HDI")) +
geom_line(aes(x=year,y=median_hdi,color="Median HDI")) +
scale_color_manual(values=c("Mean HDI"="blue","Median HDI"="red")) +
facet_wrap(~Region.Name) +
labs(x="year",y="HDI",color="Legend")
install.packages(c("askpass", "backports", "bit", "bit64", "broom", "bslib", "cachem", "callr", "classInt", "cli", "colorspace", "cowplot", "cpp11", "crayon", "credentials", "crosstalk", "curl", "data.table", "DBI", "dbplyr", "desc", "digest", "dplyr", "dtplyr", "e1071", "evaluate", "fansi", "farver", "fastmap", "fontawesome", "forcats", "gargle", "generics", "gert", "gganimate", "ggplot2", "gh", "gifski", "glue", "googledrive", "googlesheets4", "gtable", "haven", "highr", "hms", "httr2", "jsonlite", "knitr", "later", "lifecycle", "lpSolve", "lubridate", "magrittr", "maps", "mime", "munsell", "openssl", "pillar", "plotly", "prettyunits", "processx", "progress", "promises", "ps", "purrr", "R6", "ragg", "readr", "readxl", "reprex", "rJava", "rlang", "rmarkdown", "rprojroot", "rstudioapi", "rvest", "s2", "sf", "stringi", "stringr", "sys", "systemfonts", "textshaping", "tibble", "tidyr", "tidytuesdayR", "timechange", "tinytex", "transformr", "tweenr", "tzdb", "units", "usethis", "utf8", "uuid", "vctrs", "vroom", "withr", "wk", "xlsxjars", "yaml", "zip"))
source("C:/Users/russn/Downloads/script_9.R")
source("C:/Users/russn/Downloads/script_9.R")
source("C:/Users/russn/Downloads/script_9.R")
source("C:/Users/russn/Downloads/script_9.R")
# ===== INTERPRETABILITY: PARTIAL DEPENDENCE =====
cat("\n===== PARTIAL DEPENDENCE ANALYSIS =====\n")
# Get top 6 features
top_features <- importance_matrix$Feature[1:6]
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))
for (feat in top_features) {
feat_idx <- which(colnames(X_train_boost_scaled) == feat)
# Create range of values
feat_range <- seq(min(X_train_boost_scaled[, feat_idx], na.rm = TRUE),
max(X_train_boost_scaled[, feat_idx], na.rm = TRUE),
length.out = 50)
# Average predictions across feature range
X_temp <- X_train_boost_scaled
pd_preds <- numeric(50)
for (i in 1:50) {
X_temp[, feat_idx] <- feat_range[i]
d_temp <- xgb.DMatrix(data = as.matrix(X_temp))
pd_preds[i] <- mean(predict(xgb_model, d_temp))
}
plot(feat_range, pd_preds, type = "l", lwd = 2,
main = paste("Partial Dependence:", feat),
xlab = paste(feat, "(standardized)"),
ylab = "Predicted INDPRO Growth (%)")
grid()
}
par(mfrow = c(1, 1))
p1 <- ggplot(results_df_final, aes(x = actual, y = predicted)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
labs(title = "Actual vs Predicted (Test Set)",
x = "Actual INDPRO Growth (%)",
y = "Predicted INDPRO Growth (%)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
p3 <- ggplot(results_df_final, aes(x = predicted, y = residuals)) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
labs(title = "Residuals vs Predicted",
x = "Predicted INDPRO Growth (%)",
y = "Residuals") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
# ===== VISUALIZATION OF PREDICTIONS =====
results_df_final <- data.frame(
actual = y_test_boost,
predicted = y_test_pred,
residuals = y_test_boost - y_test_pred,
time_index = 1:length(y_test_boost)
)
p2 <- ggplot(results_df_final, aes(x = time_index, y = actual)) +
geom_line(aes(color = "Actual"), size = 0.7) +
geom_line(aes(y = predicted, color = "Predicted"), size = 0.7) +
scale_color_manual(values = c("Actual" = "black", "Predicted" = "steelblue")) +
labs(title = "Time Series: Actual vs Predicted",
x = "Time Index",
y = "INDPRO Growth (%)") +
theme_minimal() +
theme(legend.position = "top", plot.title = element_text(hjust = 0.5))
p4 <- ggplot(results_df_final, aes(x = residuals)) +
geom_histogram(bins = 30, fill = "steelblue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Residuals",
x = "Residuals",
y = "Frequency") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
combined_plot <- gridExtra::grid.arrange(p1, p2, p3, p4, ncol = 2)
print(combined_plot)
ggsave("xgboost_diagnostics_full.png", combined_plot, width = 14, height = 10)
source("C:/Users/russn/Downloads/script_9.R")
